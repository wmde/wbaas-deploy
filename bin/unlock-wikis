#!/bin/bash

# This script can be used to remove the read-only setting for a list of wikis.
# 
# `DOMAIN_FILE_LIST` is just the path to a plain-text file containing a list of wikibase.cloud domains, each line containing 1 wiki domain
# in the form of:
# ```
# foo.wikibase.cloud 
# bar.wikibase.cloud
# ``

set -exu

DOMAIN_FILE_LIST='./domains.txt'

for WIKI_DOMAIN in $(cat ${DOMAIN_FILE_LIST}); do
    kubectl exec -it deployment/api-app-backend -- bash -c "php artisan wbs-wiki:setSetting domain ${WIKI_DOMAIN} wgReadOnly"
done
